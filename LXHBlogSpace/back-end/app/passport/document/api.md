## passport 的API文档

2019-9-22

ver 1.0

- note1:  编码默认使用UTF8编码，对于其他编码，服务器暂未实现其支持

- note2: 

为了防止监听，导致明文密码泄露，决定在传输前将密码进行MD5算法处理。

但仍无法保证攻击者使用该摘要进行登录。**为此服务应当使用HTTPS协议**。

对于HTTPS协议的中间人攻击防御，交给浏览器和用户处理。

### 用户登录

接口路径：`/blog/v1/passport/login`

请求方法：`POST`

请求消息体：应包含以下信息，以`键名1=值&键名2=值&键名3=值`的形式组合

| 键名     | 说明                            | 例子 |
| -------- | ------------------------------- | ---- |
| username | 用户名                          | leaf |
| phex     | MD5(密码), 输出的大小写不做限制 |      |

服务端返回：

如果登录成功将返回302状态码，并进行set-cookie

失败则状态码为200，返回 JSON，包含以下数据

| 键名     | 说明                            | 例子     |
| -------- | ------------------------------- | -------- |
| "ecode"  | 整数型的错误码，无错误发生时为0 | 0        |
| "reason" | 原因，字符串类型                | 密码错误 |

关于错误码：

| 错误码 | 说明（对应的原因） |
| ------ | ------------------ |
| -1     | 请求参数有误       |
| -2     | 用户名或密码错误   |



### 用户注册

接口路径：`/blog/v1/passport/register`

请求方法：`POST`

请求消息体：应包含以下信息, 以`键名1=值&键名2=值&键名3=值`的形式组合

| 键名     | 说明 | 例子                            |
| -------- | ---- | ------------------------------- |
| username | 用户名 | leaf |
| phex     | MD5(密码), 输出的大小写不做限制     |  |
| email | 邮箱 | abc@def.com |
| vcode | 邮箱认证码 | 124500 |



### 获取用户基础信息

校验cookie中的token是否有效

接口路径：`/blog/v1/passport/GerUserInfo`

请求方法：`GET`

服务端返回：JSON，包含以下键

| 键名     | 说明                 | 例子                                         |
| -------- | -------------------- | -------------------------------------------- |
| "vaild"  | 是否有效->true/false | "true"                                       |
| "name"   | 用户名称             | “leaf"                                       |
| "avatar" | 用户头像的url        | "https://static.leaflxh.com/avatar/xxxx.jpg" |

