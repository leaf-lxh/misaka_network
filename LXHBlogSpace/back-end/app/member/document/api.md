## member模块的API文档

2019-10-4

ver1.0



## passport模块相关

### 关注用户

接口路径：`/api/v1/member/AddFollow`

请求方法：POST，携带Cookie并包含以下参数

| 参数名   | 说明             |
| -------- | ---------------- |
| username | 关注的用户的名称 |

服务端返回：JSON。包含以下字段

| 键名     | 说明     |
| -------- | -------- |
| "ecode"  | 错误码   |
| "reason" | 错误信息 |

### 取消关注用户

接口路径：`/api/v1/member/RemoveFollow`

请求方法：POST，携带Cookie并包含以下参数

| 参数名   | 说明             |
| -------- | ---------------- |
| username | 关注的用户的名称 |

服务端返回：JSON。包含以下字段

| 键名     | 说明     |
| -------- | -------- |
| "ecode"  | 错误码   |
| "reason" | 错误信息 |



### 获取关注列表

1.获取关注该用户的用户

接口路径：`/api/v1/member/GetFollowerList`

请求方法：GET，并包含以下参数

| 参数     | 说明               |
| -------- | ------------------ |
| username | 用户名             |
| page     | 欲请求的页数，可选 |

服务端返回：JSON对象，包含以下键。

| 键名        | 说明                                           |
| ----------- | ---------------------------------------------- |
| "ecode"     | 错误码                                         |
| "reason"    | 错误原因                                       |
| "user_list" | JSON array。每个元素为一个JSON对象，包含以下键 |

| 键名       | 说明                   |
| ---------- | ---------------------- |
| "username" | 用户名                 |
| "avatar"   | 头像地址               |
| "followed" | 是否已关注(true/false) |

2.获取该用户关注的用户

接口路径：`/api/v1/member/GetFollowedList`

请求方法与返回数据与上接口相同



### 获取用户关注信息

接口路径：`/api/v1/member/GetUserFollowInfo`

请求方法：GET，并包含以下参数，可包含cookie，用于检测当前登录用户是否关注该用户

| 参数     | 说明                  |
| -------- | --------------------- |
| username | 用户名，应使用url编码 |

服务端返回：JSON对象，包含以下键。

| 键名           | 说明               |
| -------------- | ------------------ |
| "ecode"        | 错误码             |
| "reason"       | 错误原因           |
| "fans_num"     | 粉丝数             |
| "followed_num" | 关注其他用户的数量 |
| "following"    | "true"/"false"     |

### 获取用户消息列表

接口路径：`/api/v1/member/GetUserMsgList`

请求方式：GET，要求携带用户Cookie

服务端返回：JSON对象，包含以下属性

| 键名       | 说明                                               |
| ---------- | -------------------------------------------------- |
| "ecode"    | 错误码                                             |
| "reason"   | 说明                                               |
| "msg_list" | 一个JSON array，每个元素为一个JSON对象，包含以下键 |

| 键名         | 说明                           |
| ------------ | ------------------------------ |
| "notice_id"  | 消息id                         |
| "title"      | 文章标题                       |
| "article_id" | 文章id                         |
| "from"       | 消息发送者的用户名             |
| "content"    | 评论内容                       |
| "time"       | unix时间戳，精确到秒           |
| "readed"     | 是否已读，"1"为已读，"0"为未读 |



### 获取系统消息列表

接口路径：`/api/v1/member/GetSystemMsgList`

请求方式：GET，要求携带用户Cookie

服务端返回：JSON对象，包含以下属性

| 键名       | 说明                                               |
| ---------- | -------------------------------------------------- |
| "ecode"    | 错误码                                             |
| "msg_list" | 一个JSON array，每个元素为一个JSON对象，包含以下键 |

| 键名        | 说明                                       |
| ----------- | ------------------------------------------ |
| "notice_id" | 消息id                                     |
| "title"     | 消息标题                                   |
| "content"   | 评论内容                                   |
| "time"      | 整数型unix时间戳，精确到秒                 |
| "readed"    | 整数型数据，表示是否已读，1为已读，0为未读 |



### 获取未读消息数量

接口路径：`/api/v1/member/GetUnreadedMsgNum`

请求方式：GET，要求携带用户Cookie

服务端返回：JSON对象，包含以下键

| 键名           | 说明                 |
| -------------- | -------------------- |
| "ecode"        | 错误码               |
| "comment_msgs" | 未读的评论消息的数量 |
| "system_msgs"  | 未读的系统消息的数量 |



### 设置消息已读

接口路径：`/api/v1/member/SetMessageReaded`

请求方式：POST，要求携带用户Cookie，并包含以下参数

| 参数      | 说明                                          |
| --------- | --------------------------------------------- |
| type      | 消息类型，用户评论消息为user,系统消息为system |
| notice_id | 消息id                                        |

服务端返回：JSON对象，包含以下键

| 键名     | 说明     |
| -------- | -------- |
| "ecode"  | 错误码   |
| "reason" | 错误说明 |

## content模块相关

### 设置访问记录

接口路径：`/api/v1/member/SetWatchedHistory`

请求方法：POST，携带用户cookie并包含以下参数

| 参数       | 说明           |
| ---------- | -------------- |
| article_id | 浏览过的文章id |

服务端返回：JSON对象，包含以下键

| 键名     | 说明     |
| -------- | -------- |
| "ecode"  | 错误码   |
| "reason" | 错误说明 |

### 获取当前用户近期的浏览记录

接口路径：`/api/v1/member/GetExplored`

请求方式：GET，要求携带用户Cookie

服务端返回：JSON对象，包含以下属性

| 键名           | 说明                                               |
| -------------- | -------------------------------------------------- |
| "ecode"        | 错误码                                             |
| "reason"       | 说明                                               |
| "history_list" | 一个JSON array，每个元素为一个JSON对象，包含以下键 |

| 键名         | 说明     |
| ------------ | -------- |
| "article_id" | 文章id   |
| "title"      | 文章标题 |
| "time"       | 浏览时间 |

### 获取热点文章的列表

接口路径：`/api/v1/member/GetHottopic`

请求方法：GET

服务端返回：JSON对象，包含以下属性

| 键名       | 说明                                                       |
| ---------- | ---------------------------------------------------------- |
| "list_len" | 热点文章的数量，最多为0                                    |
| "list"     | 热点文章，一个JSON ARRAY对象，每个数组中的对象包含以下属性 |

| 键名       | 说明     |
| ---------- | -------- |
| article_id | 文章的ID |
| title      | 文章标题 |



### 错误码对照表

| 错误码 | 说明                               |
| ------ | ---------------------------------- |
| -1     | 请求参数有误                       |
| -2     | 指定用户不存在                     |
| -3     | 指定消息不存在                     |
| -4     | 在设置消息已读时传递的消息类型有误 |
| -5     | 指定文章不存在                     |
| -6     | 用户不能关注自己                   |
|        | 已关注该用户                       |

